\documentclass[tikz,border=10pt]{standalone}
% TE / Recombination Figure 
% Author: Greg Conradi Smith 

\usepackage{tikz}
%\usepackage{pgfplots}
%\usepackage{amsmath}
 
\newcommand{\cross}[4]{%
\draw[align] (a#1.south) to (b#3.north); % alignment 
\draw[align] (a#2.south) to (b#4.north); % alignment 
\draw[recomb] (a#1.south) to (b#4.north); % recombine  
\draw[recomb] (a#2.south) to (b#3.north); % recombine   
}

\newcommand{\gene}[3]{%
\draw (a#2) node {#1};  \draw (b#3) node {#1};
\draw[thin,blue] (a#2.south) to (b#3.north);
}

\newcommand{\te}[1]{%
\draw (#1) node[both_nodes,fill=gray] {};  
}


\begin{document}

\tikzstyle{align}=[ultra thick,dashed]
\tikzstyle{recomb}=[ultra thick]
\tikzstyle{both_nodes}=[draw,rounded corners,ultra thick]
\tikzstyle{anode}=[both_nodes,fill=blue!10]
\tikzstyle{bnode}=[both_nodes,fill=gray!10]

\def\vertspace{2}
\begin{tikzpicture} [minimum size=20pt]

\foreach \i in {1,2,...,20}  {  
\draw (\i,0) node[anode] (a\i) {} node[above of=a\i,red] {\i};
\draw (\i,-\vertspace) node[bnode] (b\i) {} node[below of=b\i,red] {\i};
}

\gene{a}{1}{1}
\gene{b}{2}{3}
\gene{c}{4}{4}
\gene{d}{6}{5}
\gene{e}{8}{8}
\gene{f}{9}{9}
\gene{g}{12}{11}
\gene{h}{15}{14}
\gene{i}{16}{17}
\gene{j}{17}{18}
\gene{k}{20}{19}

\te{a5}
\te{a7}
\te{a11}
\te{a13}
\te{a19}

\te{b6}
\te{b7}
\te{b10}
\te{b12}
\te{b15}
\te{b16}
\te{b17}
\te{b20}

\cross{2}{4}
          {3}{4}
          
\cross{7}{11}
          {6}{10}
          
\cross{15}{17}
          {14}{18}

%\draw[align] (a2) to (b2); % alignment 
%\draw[align] (a3) to (b3); % alignment 
%\draw[cross] (a2) to (b3); % cross over 
%\draw[cross] (b2) to (a3); % cross over 

%\draw[bend right=50] (gb) to (gf); 

\end{tikzpicture}


\end{document}